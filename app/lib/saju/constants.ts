/**
 * 만세력 계산 모듈 - 상수 및 매핑 테이블
 * 
 * [규격]
 * - 모든 매핑은 고정값이며, 임의 수정 금지
 * - 출처: 전통 명리학 기준
 */

import type { Element, Cheongan, Cheongan漢字, Jiji, Jiji漢字 } from "./types";

// ========================
// 천간 (天干) - 10개
// ========================

/** 천간 한글 목록 (순서 중요: 0=갑, 1=을, ..., 9=계) */
export const CHEONGAN_LIST: readonly Cheongan[] = [
  "갑", "을", "병", "정", "무", "기", "경", "신", "임", "계"
] as const;

/** 천간 한자 목록 (순서 중요: CHEONGAN_LIST와 1:1 매칭) */
export const CHEONGAN_HANJA_LIST: readonly Cheongan漢字[] = [
  "甲", "乙", "丙", "丁", "戊", "己", "庚", "辛", "壬", "癸"
] as const;

/** 천간 → 오행 매핑 (고정) */
export const CHEONGAN_TO_ELEMENT: Record<Cheongan, Element> = {
  "갑": "목", "을": "목",  // 甲乙 = 木
  "병": "화", "정": "화",  // 丙丁 = 火
  "무": "토", "기": "토",  // 戊己 = 土
  "경": "금", "신": "금",  // 庚辛 = 金
  "임": "수", "계": "수",  // 壬癸 = 水
} as const;

/** 천간 한자 → 오행 매핑 */
export const CHEONGAN_HANJA_TO_ELEMENT: Record<Cheongan漢字, Element> = {
  "甲": "목", "乙": "목",
  "丙": "화", "丁": "화",
  "戊": "토", "己": "토",
  "庚": "금", "辛": "금",
  "壬": "수", "癸": "수",
} as const;

/** 천간 한자 → 한글 매핑 */
export const CHEONGAN_HANJA_TO_HANGUL: Record<Cheongan漢字, Cheongan> = {
  "甲": "갑", "乙": "을", "丙": "병", "丁": "정", "戊": "무",
  "己": "기", "庚": "경", "辛": "신", "壬": "임", "癸": "계",
} as const;

/** 천간 한글 → 한자 매핑 */
export const CHEONGAN_HANGUL_TO_HANJA: Record<Cheongan, Cheongan漢字> = {
  "갑": "甲", "을": "乙", "병": "丙", "정": "丁", "무": "戊",
  "기": "己", "경": "庚", "신": "辛", "임": "壬", "계": "癸",
} as const;

// ========================
// 지지 (地支) - 12개
// ========================

/** 지지 한글 목록 (순서 중요: 0=자, 1=축, ..., 11=해) */
export const JIJI_LIST: readonly Jiji[] = [
  "자", "축", "인", "묘", "진", "사", "오", "미", "신", "유", "술", "해"
] as const;

/** 지지 한자 목록 (순서 중요: JIJI_LIST와 1:1 매칭) */
export const JIJI_HANJA_LIST: readonly Jiji漢字[] = [
  "子", "丑", "寅", "卯", "辰", "巳", "午", "未", "申", "酉", "戌", "亥"
] as const;

/** 지지 → 오행 매핑 (고정, 기본 오행 기준) */
export const JIJI_TO_ELEMENT: Record<Jiji, Element> = {
  "인": "목", "묘": "목",                    // 寅卯 = 木
  "사": "화", "오": "화",                    // 巳午 = 火
  "신": "금", "유": "금",                    // 申酉 = 金
  "자": "수", "해": "수",                    // 子亥 = 水
  "진": "토", "술": "토", "축": "토", "미": "토",  // 辰戌丑未 = 土
} as const;

/** 지지 한자 → 오행 매핑 */
export const JIJI_HANJA_TO_ELEMENT: Record<Jiji漢字, Element> = {
  "寅": "목", "卯": "목",
  "巳": "화", "午": "화",
  "申": "금", "酉": "금",
  "子": "수", "亥": "수",
  "辰": "토", "戌": "토", "丑": "토", "未": "토",
} as const;

/** 지지 한자 → 한글 매핑 */
export const JIJI_HANJA_TO_HANGUL: Record<Jiji漢字, Jiji> = {
  "子": "자", "丑": "축", "寅": "인", "卯": "묘",
  "辰": "진", "巳": "사", "午": "오", "未": "미",
  "申": "신", "酉": "유", "戌": "술", "亥": "해",
} as const;

/** 지지 한글 → 한자 매핑 */
export const JIJI_HANGUL_TO_HANJA: Record<Jiji, Jiji漢字> = {
  "자": "子", "축": "丑", "인": "寅", "묘": "卯",
  "진": "辰", "사": "巳", "오": "午", "미": "未",
  "신": "申", "유": "酉", "술": "戌", "해": "亥",
} as const;

// ========================
// 시주 계산용 매핑
// ========================

/**
 * 시간 → 지지 인덱스 변환
 * 
 * 시진(時辰) 배당:
 * - 자시: 23:00 ~ 01:00 (인덱스 0)
 * - 축시: 01:00 ~ 03:00 (인덱스 1)
 * - 인시: 03:00 ~ 05:00 (인덱스 2)
 * - ...
 * - 해시: 21:00 ~ 23:00 (인덱스 11)
 */
export const HOUR_TO_JIJI_INDEX: readonly number[] = [
  0,  // 00시 → 자시
  0,  // 01시 → 자시 (자시 끝)
  1,  // 02시 → 축시 시작
  1,  // 03시 → 축시
  2,  // 04시 → 인시 시작
  2,  // 05시 → 인시
  3,  // 06시 → 묘시 시작
  3,  // 07시 → 묘시
  4,  // 08시 → 진시 시작
  4,  // 09시 → 진시
  5,  // 10시 → 사시 시작
  5,  // 11시 → 사시
  6,  // 12시 → 오시 시작
  6,  // 13시 → 오시
  7,  // 14시 → 미시 시작
  7,  // 15시 → 미시
  8,  // 16시 → 신시 시작
  8,  // 17시 → 신시
  9,  // 18시 → 유시 시작
  9,  // 19시 → 유시
  10, // 20시 → 술시 시작
  10, // 21시 → 술시
  11, // 22시 → 해시 시작
  11, // 23시 → 해시
] as const;

/**
 * 일간(日干) 기준 시간 천간 시작 인덱스
 * 
 * 오호연원법(五虎遁元法):
 * - 갑/기일 → 갑(0)부터 시작
 * - 을/경일 → 병(2)부터 시작
 * - 병/신일 → 무(4)부터 시작
 * - 정/임일 → 경(6)부터 시작
 * - 무/계일 → 임(8)부터 시작
 */
export const ILGAN_TO_HOUR_CHEONGAN_START: Record<Cheongan, number> = {
  "갑": 0, "기": 0,  // 갑기 → 자시가 갑자
  "을": 2, "경": 2,  // 을경 → 자시가 병자
  "병": 4, "신": 4,  // 병신 → 자시가 무자
  "정": 6, "임": 6,  // 정임 → 자시가 경자
  "무": 8, "계": 8,  // 무계 → 자시가 임자
} as const;

// ========================
// 오행 관련
// ========================

/** 오행 목록 (고정 순서) */
export const ELEMENT_LIST: readonly Element[] = ["목", "화", "토", "금", "수"] as const;

/** 오행 초기값 (분포 계산용) */
export const ELEMENT_INITIAL: Record<Element, number> = {
  "목": 0,
  "화": 0,
  "토": 0,
  "금": 0,
  "수": 0,
} as const;

// ========================
// 검증용 상수
// ========================

/** 시주 포함 시 오행 총합 (천간 4 + 지지 4) */
export const ELEMENT_TOTAL_WITH_HOUR = 8;

/** 시주 미포함 시 오행 총합 (천간 3 + 지지 3) */
export const ELEMENT_TOTAL_WITHOUT_HOUR = 6;
